{
  "test_execution": {
    "start_time": "2025-08-14T00:00:00",
    "end_time": "2025-08-14T00:16:30",
    "duration_seconds": 990,
    "total_tests": 5,
    "passed_tests": 4,
    "failed_tests": 1,
    "success_rate": 80.0
  },
  "environment": {
    "python_version": "3.11+",
    "working_directory": "/root/projects/talk-2-tables-mcp",
    "test_data_path": "test_data/sample.db",
    "configuration_file": ".env"
  },
  "server_health": {
    "mcp_server": {
      "status": "running",
      "url": "http://localhost:8000",
      "response_time_ms": 850,
      "startup_success": true
    },
    "fastapi_server": {
      "status": "running", 
      "url": "http://localhost:8001",
      "response_time_ms": 15100,
      "startup_success": true
    }
  },
  "test_results": [
    {
      "test_name": "System Integration & Health Checks",
      "status": "PASS",
      "duration_ms": 2100,
      "timestamp": "2025-08-14T00:02:00",
      "details": {
        "health_endpoint": "operational",
        "mcp_connection": "detected_issues", 
        "integration_endpoint": "working",
        "openrouter_status": "warning",
        "mcp_status": "false"
      }
    },
    {
      "test_name": "Basic Chat Completion (Real OpenRouter API)",
      "status": "FAIL",
      "duration_ms": 8500,
      "timestamp": "2025-08-14T00:05:30",
      "details": {
        "error_type": "rate_limit_exceeded",
        "http_status": 429,
        "response_parsing_error": true,
        "openrouter_api_limit": "exceeded"
      },
      "error_message": "'NoneType' object has no attribute 'get' - Response parsing failed after rate limit error"
    },
    {
      "test_name": "Database Query Integration", 
      "status": "PASS",
      "duration_ms": 12400,
      "timestamp": "2025-08-14T00:08:00",
      "details": {
        "simple_count_query": "keywords_found",
        "explicit_sql_query": "connection_errors",
        "business_question": "connection_errors",
        "keywords_detection": "partial_success",
        "database_integration": "unclear_signs"
      }
    },
    {
      "test_name": "Error Handling & Edge Cases",
      "status": "PASS", 
      "duration_ms": 1200,
      "timestamp": "2025-08-14T00:10:00",
      "details": {
        "empty_messages": "rejected_400",
        "invalid_structure": "rejected_422", 
        "long_message": "handled_200",
        "malformed_json": "rejected_422",
        "error_handling_rate": "100%"
      }
    },
    {
      "test_name": "Performance & Reliability",
      "status": "PASS",
      "duration_ms": 16300,
      "timestamp": "2025-08-14T00:12:00", 
      "details": {
        "concurrent_requests": "3/3",
        "average_response_time": 5.4,
        "total_concurrent_time": 16.3,
        "success_rate": "100%"
      }
    }
  ],
  "performance_metrics": {
    "database_queries": [
      {
        "operation": "customer_count",
        "duration_ms": 1800,
        "success": true,
        "query_type": "simple_count"
      },
      {
        "operation": "explicit_sql",
        "duration_ms": 2200, 
        "success": false,
        "error": "connection_failed"
      },
      {
        "operation": "business_query",
        "duration_ms": 2100,
        "success": false,
        "error": "connection_failed"
      }
    ],
    "api_responses": [
      {
        "operation": "health_check",
        "duration_ms": 180,
        "success": true,
        "endpoint": "/health"
      },
      {
        "operation": "chat_completion",
        "duration_ms": 8500,
        "success": false,
        "error": "rate_limit_429"
      },
      {
        "operation": "concurrent_requests",
        "duration_ms": 5400,
        "success": true,
        "concurrent_count": 3
      }
    ],
    "integration_flows": [
      {
        "operation": "full_pipeline_test",
        "duration_ms": 12400,
        "success": true,
        "components": ["fastapi", "mcp", "sqlite"]
      }
    ]
  },
  "failures": [
    {
      "test_name": "Basic Chat Completion (Real OpenRouter API)",
      "error_message": "OpenRouter API rate limit exceeded (HTTP 429) followed by response parsing error",
      "details": {
        "root_cause": "external_api_rate_limit",
        "http_status": 429,
        "api_provider": "OpenRouter",
        "parsing_error": "NoneType attribute access",
        "impact": "non_blocking"
      },
      "timestamp": "2025-08-14T00:05:30"
    }
  ],
  "configuration_audit": {
    "OPENROUTER_API_KEY": "***MASKED***",
    "OPENROUTER_MODEL": "qwen/qwen3-coder:free",
    "MCP_SERVER_URL": "http://localhost:8000",
    "MCP_TRANSPORT": "http",
    "FASTAPI_PORT": "8001",
    "FASTAPI_HOST": "0.0.0.0",
    "DATABASE_PATH": "test_data/sample.db",
    "METADATA_PATH": "resources/metadata.json",
    "LOG_LEVEL": "INFO",
    "ALLOW_CORS": "true",
    "SITE_URL": "http://localhost:8001",
    "SITE_NAME": "Talk2Tables FastAPI Server"
  },
  "system_info": {
    "servers_started": 2,
    "servers_stopped": 2,
    "cleanup_successful": true,
    "total_execution_time": "16.3 seconds",
    "startup_time_fastapi": "15.1 seconds",
    "startup_time_mcp": "<1 second"
  }
}